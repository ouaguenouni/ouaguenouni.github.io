<div id="chart"></div>
<script>
    const margin = {top: 20, right: 30, bottom: 40, left: 50};
    const width = 720 - margin.left - margin.right;
    const height = 500 - margin.top - margin.bottom;

    const svg = d3.select("#chart")
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

    const xScale = d3.scaleLinear().domain([-2, 16]).range([0, width]);
    const yScale = d3.scaleLinear().domain([-10, 25]).range([height, 0]);

    svg.append("g")
        .attr("transform", `translate(0,${height})`)
        .call(d3.axisBottom(xScale).ticks(8));

    svg.append("g")
        .call(d3.axisLeft(yScale).ticks(7));

    svg.append("g")
        .attr("class", "grid")
        .attr("opacity", 0.1)
        .call(d3.axisLeft(yScale).tickSize(-width).tickFormat(""));

    svg.append("g")
        .attr("class", "grid")
        .attr("transform", `translate(0,${height})`)
        .attr("opacity", 0.1)
        .call(d3.axisBottom(xScale).tickSize(-height).tickFormat(""));

    const line = d3.line()
        .x(d => xScale(d.x))
        .y(d => yScale(d.y));

    const data1 = d3.range(-2, 16.5, 0.5).map(x => ({x, y: x + 7.5}));
    const data2 = d3.range(-2, 16.5, 0.5).map(x => ({x, y: -2*x + 20}));

    svg.append("path")
        .datum(data1)
        .attr("fill", "none")
        .attr("stroke", "steelblue")
        .attr("stroke-width", 2)
        .attr("d", line);

    svg.append("path")
        .datum(data2)
        .attr("fill", "none")
        .attr("stroke", "coral")
        .attr("stroke-width", 2)
        .attr("d", line);

    const legend = svg.append("g")
        .attr("transform", "translate(10, 380)");

    legend.append("rect")
        .attr("width", 120)
        .attr("height", 45)
        .attr("fill", "white")
        .attr("stroke", "black");

    legend.append("line")
        .attr("x1", 10).attr("x2", 40)
        .attr("y1", 15).attr("y2", 15)
        .attr("stroke", "steelblue")
        .attr("stroke-width", 2);

    legend.append("text")
        .attr("x", 45).attr("y", 19)
        .text("Y=x + 7.5")
        .attr("font-size", "12px");

    legend.append("line")
        .attr("x1", 10).attr("x2", 40)
        .attr("y1", 33).attr("y2", 33)
        .attr("stroke", "coral")
        .attr("stroke-width", 2);

    legend.append("text")
        .attr("x", 45).attr("y", 37)
        .text("Y= -2x + 20")
        .attr("font-size", "12px");

    // Add interactive overlay
    const focus = svg.append("g").style("display", "none");

    focus.append("line")
        .attr("class", "x-hover-line")
        .attr("stroke", "black")
        .attr("stroke-width", 1)
        .attr("stroke-dasharray", "3,3");

    focus.append("circle")
        .attr("class", "circle1")
        .attr("r", 5)
        .attr("fill", "steelblue");

    focus.append("circle")
        .attr("class", "circle2")
        .attr("r", 5)
        .attr("fill", "coral");

    focus.append("text")
        .attr("class", "text1")
        .attr("dx", 8)
        .attr("dy", -8)
        .attr("font-size", "12px");

    focus.append("text")
        .attr("class", "text2")
        .attr("dx", 8)
        .attr("dy", 8)
        .attr("font-size", "12px");

    svg.append("rect")
        .attr("class", "overlay")
        .attr("width", width)
        .attr("height", height)
        .attr("fill", "none")
        .attr("pointer-events", "all")
        .on("mouseover", () => focus.style("display", null))
        .on("mouseout", () => focus.style("display", "none"))
        .on("mousemove", mousemove);

    function mousemove(event) {
        const [mx] = d3.pointer(event);
        const x = xScale.invert(mx);
        const y1 = x + 7.5;
        const y2 = -2 * x + 20;

        focus.select(".x-hover-line")
            .attr("x1", xScale(x))
            .attr("x2", xScale(x))
            .attr("y1", 0)
            .attr("y2", height);

        focus.select(".circle1")
            .attr("cx", xScale(x))
            .attr("cy", yScale(y1));

        focus.select(".circle2")
            .attr("cx", xScale(x))
            .attr("cy", yScale(y2));

        focus.select(".text1")
            .attr("x", xScale(x))
            .attr("y", yScale(y1))
            .text(`(${x.toFixed(1)}, ${y1.toFixed(1)})`);

        focus.select(".text2")
            .attr("x", xScale(x))
            .attr("y", yScale(y2))
            .text(`(${x.toFixed(1)}, ${y2.toFixed(1)})`);
    }
</script>